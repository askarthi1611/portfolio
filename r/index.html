<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dynamic Document Tab Viewer</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
    }

    .tabs {
      display: flex;
      background-color: #333;
      overflow-x: auto;
      white-space: nowrap;
      flex-wrap: wrap;
      gap: 5px;
      position:sticky;
      top: 0;
    }

    .tab {
      padding: 14px 16px;
      color: white;
      cursor: pointer;
      background-color: #333;
      border: none;
      outline: none;
      transition: background-color 0.3s;
      flex-shrink: 0;
    }

    .tab:hover {
      background-color: #555;
    }

    .tab.active {
      background-color: #0078d7;
    }

    iframe,
    #docx-viewer {
      width: 100%;
      height: calc(100vh - 50px);
      border: none;
      display: none;
    }

    .active {
      display: block !important;
    }
  </style>
</head>

<body>

  <div class="tabs" id="tabs"></div>
  <div id="viewer"></div>

  <!-- Mammoth.js for DOCX rendering -->
  <script src="https://unpkg.com/mammoth/mammoth.browser.min.js"></script>

  <script>

    // Your files list
    const docFiles = [
      "doc/Interview.pdf",
      "doc/book.pdf",
      "doc/TECHNICAL INTERVIEW ANSWERS.docx",
      "doc/GENERAL INTERVIEW ANSWERS.docx",
      "doc/JavaScript&HTML.docx",
      "doc/Realtime Interview QA.pdf",
      "doc/Karthikeyan_S.pdf",
      "doc/Karthikeyan_S1.pdf",
      "doc/Karthikeyan_S2.pdf",
    ];

    const tabsContainer = document.getElementById("tabs");
    const viewerContainer = document.getElementById("viewer");

    docFiles.forEach((file, index) => {
      const fileName = file.split("/").pop();
      const ext = file.split(".").pop().toLowerCase();

      // Create Tab
      const tab = document.createElement("button");
      tab.classList.add("tab");
      if (index === 0) tab.classList.add("active");
      tab.textContent = fileName.replace(/\.(pdf|docx|doc)/, "");
      tab.addEventListener("click", () => showDoc(index));
      tabsContainer.appendChild(tab);

      // Create viewer element
      let viewerElement;

      if (ext === "pdf") {
        // PDF iframe
        viewerElement = document.createElement("iframe");
        viewerElement.src = "./../" + file;
      }
      else if (ext === "docx" || ext === "doc") {
        // DOCX HTML container
        viewerElement = document.createElement("div");
        viewerElement.id = "docx-viewer-" + index;
        viewerElement.style.padding = "20px";

        // Load DOCX â†’ HTML
        fetch("./../" + file)
          .then(res => res.arrayBuffer())
          .then(buffer => mammoth.convertToHtml({ arrayBuffer: buffer }))
          .then(result => viewerElement.innerHTML = result.value)
          .catch(err => viewerElement.innerHTML = "Error loading DOCX file.");
      }

      if (index === 0) {
        viewerElement.classList.add("active");
      } else {
        viewerElement.style.display='none'
      }
      viewerContainer.appendChild(viewerElement);
    });

    function showDoc(index) {
      const viewers = viewerContainer.children;
      const tabs = document.querySelectorAll(".tab");

      Array.from(viewers).forEach((v, i) => {
        v.classList.toggle("active", i === index);
      });

      tabs.forEach((t, i) => {
        t.classList.toggle("active", i === index);
      });
    }

  </script>

</body>

</html>